import React from 'react';
import PropTypes from 'prop-types';
import i18n from 'meteor/universe:i18n';
import { useQuery } from '@apollo/react-hooks';
import Row from 'antd/lib/row';
import Col from 'antd/lib/col';
import PageHeader from '../components/PageHeader';
import Loading from '../components/Loading';
import NotFound from '../pages/NotFound';

import Edit{{ pascalCase (singular name) }}Button from './components/Edit{{ pascalCase (singular name) }}Button'

import { {{ camelCase (singular name) }} as {{ camelCase (singular name) }}Query } from './queries/{{ pascalCase name }}.gql';

import StyledView{{ pascalCase (singular name) }} from './StyledView{{ pascalCase (singular name) }}';

const View{{ pascalCase (singular name) }} = ({ match }) => {
  const { loading, data: { {{ camelCase (singular name) }} } = {} } = useQuery({{ camelCase (singular name) }}Query, { variables: { {{ urlKeyField }}: match.params.{{ urlKeyField }} } });

  return (
    <StyledView{{ pascalCase (singular name) }}>
      <PageHeader title={i18n.__('{{ pascalCase name }}.view_{{ snakeCase (singular name) }}')} />
      { {{~ camelCase (singular name) }} && <Edit{{ pascalCase (singular name) }}Button {{urlKeyField}}={ {{~ camelCase (singular name) }}.{{ urlKeyField ~}} } />}
      <Row>
        <Col xs={24} sm={24} md={20} lg={16}>
          {loading ? (
            <Loading />
          ) : (
            <>{ {{~ camelCase (singular name) }} ? <View{{ pascalCase (singular name) }}Fields {{ camelCase (singular name) }}={ {{~ camelCase (singular name) ~}} } /> : <NotFound />}</>
          )}
        </Col>
      </Row>
    </StyledView{{ pascalCase (singular name) }}>
  );
};

View{{ pascalCase (singular name) }}.propTypes = {
  // history: PropTypes.object.isRequired,
  match: PropTypes.object.isRequired,
};

const View{{ pascalCase (singular name) }}Fields = ({ {{ camelCase (singular name) }} }) => {
  return (
    <>
      {Object.entries({{ camelCase (singular name) }}).map(([label, value]) => (
        <View{{ pascalCase (singular name) }}Field key={label} label={label} value={value} />
      ))}
    </>
  );
};

View{{ pascalCase (singular name) }}Fields.propTypes = {
  {{ camelCase (singular name) }}: PropTypes.object.isRequired,
};

const View{{ pascalCase (singular name) }}Field = ({ label, value }) => {
  return (
    <Row gutter={50}>
      <Col xs={12}>{label}</Col>
      <Col xs={12} >{value.toString()}</Col>
    </Row>
  );
};

View{{ pascalCase (singular name) }}Field.propTypes = {
  label: PropTypes.string.isRequired,
  value: PropTypes.any.isRequired,
};

export default View{{ pascalCase (singular name) }};
